<div class="row">
  <% if @cart.empty? %>
  <div class="main empty-cart table-center-wrap">
    <i class="glyphicon glyphicon-shopping-cart table-center bg-img"></i>
    <div class="table-center-wrap empty-cart-desc inherit-height">
      <div class="table-center">
        <p>购物车里没有商品</p>
        <a class="btn btn-lg icon-link-right highlight-link" href="<%=@back_url%>">
          <span>立即前往采购<i class="glyphicon glyphicon-arrow-right"></i></span>
        </a>
      </div>
    </div>
  </div>
  <% else %>
  <div class="main">
    <div>
      <div class="col-sm-2 col-md-3 not-small-screen">
        <h3 style="margin-top:30px;">您选购的商品</h3>
      </div>
      <div class="col-sm-10 col-md-9 col-xs-12">
        <% @cart.each do |product| %>
          <div class="cart row">
            <div class="cart-product-info">
              <!-- Image -->
              <div class="col-md-3 col-sm-3 col-xs-3 talbe-center-wrap inherit-height">
                <a href="/products/<%= product['id']%>" class="table-center inherit-height cart-image">
                  <%= image_tag product['detail'].cover_image %>
                </a>
              </div>
              <!-- Name -->
              <div class="col-md-6 col-sm-6 col-xs-5 order-item-name">
                <a href="/products/<%= product['id']%>" class="table-center inherit-height cart-image">
                  <div><%= product['detail'].name%></div>
                  <% unless product["spec"].nil? %>
                    <div style="color: #999;font-size: 12px;"><%= product["spec"].value %></div>
                  <% end %>
                </a>
              </div>
              <!-- Price -->
              <div class="col-md-3 col-sm-3 col-xs-4">
                <div class="list-item" style="overflow:hidden;">
                  <div class="price "><%= number_to_currency unit_price(product), precision: 2 %></div>
                </div>
              </div>
            </div>
            <div class="">
              <!-- Control -->
              <% if product["expired"] %>
              <div class="col-md-8 col-sm-8 col-xs-8 number-input-group">
                <p class="text-danger" style="padding-left:15px;">该商品已经失效！</p>
              </div>
              <% else %>
              <div class="col-md-8 col-sm-8 col-xs-8 number-input-group">
                <button onclick="carts.remove('<%=product['id']%>', '<%=product['spec_id']%>')"><i class="glyphicon glyphicon-minus"></i></button>
                <%= number_field_tag "count_#{product['id']}_#{product['spec_id']}", product["count"],
                    onchange: "carts.updateCount(this, #{product['id']}, '#{product['spec_id']}')", min: 1%>
                <button onclick="carts.add('<%=product['id']%>', '<%=product['spec_id']%>')"><i class="glyphicon glyphicon-plus"></i></button>
              </div>
              <% end %>
              <!-- Delete -->
              <div class="list-item col-xs-4 col-md-4 col-sm-4">
                <%= form_tag :carts_del_product, method: "DELETE" do %>
                <input type="hidden" name="id" value="<%=product['id']%>">
                <input type="hidden" name="spec_id" value="<%=product['spec_id']%>">
                <button type="submit" class="btn icon icon-danger" style="margin-right: -30px;">
                  <i class="glyphicon glyphicon-trash"></i>
                </button>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
        <div class="subtotal">
          <label class="pull-left label">合计</label>
          <div class="pull-right price" id="subtotal"><%= number_to_currency cart_price(@cart), locale: :'zh-CN', precision: 2 %></div>
        </div>
        <div class="vertical-btn-group">
          <a class="btn btn-lg btn-default" href="<%=@back_url%>">继续购物</a>
          <% unless @has_expired_product %>
          <a id="confirm_carts_btn" class="btn btn-lg btn-primary" href="/orders/confirm">确认订单</a>
          <% end %>
        </div>

      </div>

    </div>
  </div>
<% end %>

</div>
