<h1 class="page-header">店铺管理</h1>
<%= link_to new_admin_group_path,  class: "btn btn-default" do %>
<span class="glyphicon glyphicon-plus"></span> 新建
<% end %>

<table class="table">
  <thead>
    <tr>
      <th>名字</th>
      <th>所属店铺</th>
      <th>店铺URL</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    <% @groups.each do |group| %>
    <tr>
      <td><%= group.name  %></td>
      <td><%= group.parent.name unless group.parent.nil? %></td>
      <td>
        <% if group.shop.present? %>
        http://<%=Rails.application.config.domain%>/shops/<%=group.shop.id%>
        <% end %>
      </td>
      <td>
        <%= link_to admin_group_path(group) do %>
        <span class="glyphicon glyphicon-eye-open icon"></span>
        <% end %>

        <%= link_to edit_admin_group_path(group) do %>
          <span class="glyphicon glyphicon-pencil icon"></span>
        <% end %>

        <a href="#" onclick="group.showQRcode(<%=group.id%>, '<%=group.name%>')">
          <span class="glyphicon glyphicon-qrcode"></span>
        </a>

        <% if group.parent_id.present? %>
        <%= link_to admin_group_path(group), method: :delete, data: {confirm: %(确定要删除"#{group.name}"吗？)} do %>
          <span class="glyphicon glyphicon-trash icon"></span>
        <% end %>
        <% end %>
      </td>
    </tr>
    <% end %>
  </tbody>
  <tfoot>
    <tr>
      <td colspan="6">
        <%= page_info @groups %>
        <%= will_paginate @groups, class: "apple_pagination" %>
      </td>
    </tr>
    </tfoot>
</table>
<div class="modal fade" id="qrcodeModal" tabindex="-1" role="dialog" aria-labelledby="qrcodeModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="qrcodeModalLabel"></h4>
      </div>
      <div class="modal-body" id="qrcodeBody">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
