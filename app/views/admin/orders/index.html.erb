<h1 class="page-header">订单管理</h1>

  <form action="<%= admin_orders_path %>" method="get" class="form-inline">
    <div class="form-group">
      <%= text_field_tag :order_id_or_tel, @order_id_or_tel, class: "form-control", placeholder: "订单号/手机号" %>
    </div>
    <div class="form-group">
      <%= date_field_tag :order_date, @order_date, class: "form-control" %>
    </div>
    <%= submit_tag "搜索", class: "btn btn-default"%>
    <button type="button" onclick="utility.resetForm(this)" class="btn btn-default" >重置</button>
  </form>
</div>
<div>
  <%= link_to "等待付款", "#{admin_orders_path}?type=unpaid", class: "#{'highlight' if @type.eql?('unpaid')} filter-link" %>
    <%= link_to "等待发货", "#{admin_orders_path}?type=wait_shipping", class: "#{'highlight' if @type.eql?('wait_shipping')} filter-link" %>
      <%= link_to "等待收货", "#{admin_orders_path}?type=wait_delivery", class: "#{'highlight' if @type.eql?('wait_delivery')} filter-link" %>
        <%= link_to "已完成", "#{admin_orders_path}?type=finished", class: "#{'highlight' if @type.eql?('finished')} filter-link" %>
          <%= link_to "已取消", "#{admin_orders_path}?type=canceled", class: "#{'highlight' if @type.eql?('canceled')} filter-link" %>
  </div>
<table class="table">
  <thead>
    <tr>
      <th>订单号</th>
      <th>用户</th>
      <th class="number">总价</th>
      <th>状态</th>
      <th>支付方式</th>
      <th>创建时间</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    <% @orders.each_with_index do |order, index| %>
      <tr>
        <td><%= order.order_id  %></td>
        <td><%= order.customer.tel  %></td>
        <td class="number"><%= number_to_currency order.subtotal, locale: :'zh-CN', precision: 2  %></td>
        <td><%= order_status order %></td>
        <td><%= order_payment order %></td>
        <td><%= display_datetime order.created_at %></td>
        <td>
          <%= link_to admin_order_path(order) do %>
            <span class="glyphicon glyphicon-eye-open"></span></button>
<% end %>
      </td>
    </tr>
    <% end %>
  </tbody>
  <tfooter>
    <tr>
      <td colspan="6">
        <%= page_info @orders %>
        <%= will_paginate @orders, class: "apple_pagination" %>
      </td>
    </tr>
  </tfooter>
</table>
