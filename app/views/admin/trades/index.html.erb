<h1 class="page-header">交易流水查询</h1>

<%= form_tag "", method: "GET", class: "form-inline query-form" do %>
<div class="form-group">
  <label class="control-label">供应商</label>
  <%= select_tag :supplier, supplier_options(@supplier), include_blank: true, class: "form-control"%>
</div>
<div class="form-group">
  <label class="control-label">交易日期</label>
  <%= date_field_tag :date_start, @date_start, class: "form-control" %> -
  <%= date_field_tag :date_end, @date_end, class: "form-control" %>
</div>
<%= submit_tag "搜索", class: "btn btn-default"%>
<button type="reset" class="btn btn-default" >重置</button>
<%= submit_tag "导出Excel", name: "export", class: "pull-right btn btn-default" %>
<% end %>

<table class="table">
  <thead>
    <tr>
      <th>交易时间</th>
      <th>交易类型</th>
      <th>交易对方</th>
      <th>供应商</th>
      <th>订单号</th>
      <th>交易流水号</th>
      <th class="number-align">入账（元）</th>
      <th class="number-align">出账（元）</th>
      <th class="number-align">余额（元）</th>
    </tr>
  </thead>
  <tbody>
    <% @trades.each do |trade| %>
    <tr>
      <td><%= display_datetime trade.time %></td>
      <td><%= trade_type trade %></td>
      <td><%= trade.payer %></td>
      <td><%= trade.supplier || "-" %></td>
      <td><%= trade.order_no %></td>
      <td><%= trade.trade_no || "-" %></td>
      <td class="number-align"><%= trade.receipt %></td>
      <td class="number-align"><%= trade.disbursement %></td>
      <td class="number-align"><%= @supplier.present? ? trade.supplier_balance : trade.balance %></td>
    </tr>
    <% end %>
  </tbody>
  <tfoot>
    <tr>
      <td colspan="9">
        <%= page_info @trades %>
        <%= will_paginate @trades, page_links: false %>
      </td>
    </tr>
    </tfoot>
</table>
